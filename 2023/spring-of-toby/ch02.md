# 2장 테스트

- 키워드
    - Spring TestContext Framework, Application Context, Junit
- 질문 만들기
    - 테스트 결과에 있어서 중요한 건?
    - 왜 JUnit은 테스트 메소드를 실행할 때마다 새로운 오브젝트를 만들까?
    - 픽스처란?
    - 애플리케이션 컨텍스트와 빈팩토리의 차이점은?
    - Spring TestContext Framework가 뭔지, 그리고 기능은?
    - 왜 구현 클래스를 바꿀 계획이 없더라도 인터페이스를 두고 DI를 적용해야할까?
    - 테스트코드에서는 의존성을 주입할 때 어떻게 하는 게 좋을까?
- 질문 답안
    - 테스트 결과에 있어서 중요한 건?
        - 일관성이 중요하다.
            - 코드의 변경없이 테스트 실행 순서나 환경에 의해 결과가 바껴선 안된다.
    - 왜 JUnit은 테스트 메소드를 실행할 때마다 새로운 오브젝트를 만들까?
        - 각 테스트가 다른 테스트들과 서로 영향을 미치지않고 **독립적으로 실행함을 보장**하기 위해서다.
        - 따라서 인스턴스 변수도 부담없이 사용할 수 있다.
            - 왜냐하면 다른 테스트 메소드가 실행될 때는 새 오브젝트가 만들어지고 기존 변수는 초기화되기 때문이다.
    - 픽스처란?
        - 테스트를 수행하는데 필요한 정보나 오브젝트
        - 일반적으로 픽스처는 여러 테스트에서 반복적으로 실행되기 때문에 `@Before` 메소드를 이용해 생성해놓으면 편하다.
    - 애플리케이션 컨텍스트와 빈팩토리의 차이점은?
        - 빈팩토리
            - lazy loading
            - getBean() 메서드를 호출할 때 빈을 생성한다.
        - 애플리케이션 컨텍스트
            - eager loading
            - 컨테이너가 만들어질 때 모든 빈을 생성한다.
                - 빈팩토리에 비해 초기화 시간이 길다.
    - Spring TestContext Framework가 뭔지, 그리고 기능은?

      테스트에서 사용되는 application context를 생성, 관리 그리고 테스트에 적용하는 기능을 가진 테스트 프레임워크이다.

        - 예시: Junit
        - 기능
            - 하나의 테스트 클래스 안에서 application context 공유하게 해준다.
            - 그리고 심지어 **설정파일이 동일하다면** 다른 클래스라도 application context 를 공유하게 해준다.
    - 왜 구현 클래스를 바꿀 계획이 없더라도 인터페이스를 두고 DI를 적용해야할까?
        - 소프트웨어 개발에서 바뀌지 않는 것은 없다.
            - 추구 요구사항이 변경했을 때 코드를 수정하는 것보다 DI 구현이 훨씬 쉽다.
        - 구현체가 바뀌지 않는다고 하더라도 인터페이스를 두고 DI를 적용하면 다른 차원의 서비스를 도입할 수 있다.
            - 스프링은 이런 기능을 일반화해서 AOP라는 기술로 만들어주기도 한다.
            - 책의 예시: DB 커넥션의 개수 카운팅하는 부가기능
        - 효율적인 테스트 작성을 위함
            - 테스트를 잘 활용하려면?
                - 자동으로 실행 가능하며 빠르게 동작하도록 테스크코드를 작성해야 한다.
                    - 테스트할 대상의 범위가 넓어지면 테스트 작성하기 어려움
                    - DI는 테스트가 작은 단위의 대상에 대해 **독립적**으로 만들어지고 실행되게 하는 데 중요한 역할을 한다.
    - 테스트코드에서는 의존성을 주입할 때 어떻게 하는 게 좋을까?
        - 스프링 컨테이너 없이 테스트 할 수 있는 방법이 가장 빠르고 간결하다.
        - 그런데 만약 의존관계가 복잡하다면, 스프링 설정을 이용해서 DI 방식을 이용하자.
            - 테스트 환경을 위한 설정파일을 별도로 만든다.